{"ast":null,"code":"import _slicedToArray from\"/Users/shalom/Desktop/\\u05EA\\u05D9\\u05E7\\u05D9\\u05D4 \\u05DC\\u05DC\\u05D0 \\u05E9\\u05DD 2/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import Login from\"./Login.js\";import Register from\"./Register.js\";import ProtectedRoute from\"./ProtectedRoute.js\";import{Routes,Route}from'react-router-dom';import*as auth from\"../utils/auth\";import{useNavigate}from'react-router-dom';import App from'./App';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Router=function Router(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),loggedIn=_React$useState2[0],setLoggedIn=_React$useState2[1];var _React$useState3=React.useState(\"\"),_React$useState4=_slicedToArray(_React$useState3,2),email=_React$useState4[0],setEmail=_React$useState4[1];var _React$useState5=React.useState(\"\"),_React$useState6=_slicedToArray(_React$useState5,2),token=_React$useState6[0],setToken=_React$useState6[1];var navigate=useNavigate();var handelLogin=function handelLogin(email){setLoggedIn(true);setEmail(email);navigate(\"/\");};// const handelLogout =()=>{\n//   setLoggedIn(false)\n// }\nvar tokenCheck=function tokenCheck(){var jwt=localStorage.getItem('jwt');if(jwt){auth.checkToken(jwt).then(function(res){if(res.status===400){console.log(\" Token not provided or provided in the wrong format \");}if(res.status===401){console.log(\"The provided token is invalid\");}if(res){handelLogin();setEmail(res.data.email);navigate(\"/\");}}).catch(function(err){console.log(err);localStorage.clear();});;}};var handelLoginSubmit=function handelLoginSubmit(_ref){var email=_ref.email,password=_ref.password;auth.login(email,password).then(function(data){if(data.token){localStorage.setItem('jwt',data.token);handelLogin(email);setToken(data.token);}if(data.status===400){console.log(\" one or more of the fields were not provided \");}if(data.status===401){console.log(\"the user with the specified email not found \");}}).catch(function(err){return console.log(err);});};React.useEffect(function(){tokenCheck();},[]);return/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isLoggedIn:loggedIn,email:email,component:App})}),/*#__PURE__*/_jsx(Route,{path:\"/signin\",element:/*#__PURE__*/_jsx(Login,{handelLoginSubmit:handelLoginSubmit})}),/*#__PURE__*/_jsx(Route,{path:\"/signup\",element:/*#__PURE__*/_jsx(Register,{})})]});};export default Router;","map":{"version":3,"names":["React","Login","Register","ProtectedRoute","Routes","Route","auth","useNavigate","App","Router","useState","loggedIn","setLoggedIn","email","setEmail","token","setToken","navigate","handelLogin","tokenCheck","jwt","localStorage","getItem","checkToken","then","res","status","console","log","data","catch","err","clear","handelLoginSubmit","password","login","setItem","useEffect"],"sources":["/Users/shalom/Desktop/תיקיה ללא שם 2/frontend/src/components/Router.js"],"sourcesContent":["import React from 'react';\r\nimport Login from \"./Login.js\";\r\nimport Register from \"./Register.js\";\r\nimport ProtectedRoute from \"./ProtectedRoute.js\";\r\nimport {  Routes,Route } from 'react-router-dom';\r\nimport * as auth from \"../utils/auth\";\r\nimport {  useNavigate } from 'react-router-dom';\r\nimport App  from './App';\r\nconst Router = () =>{\r\nconst [loggedIn, setLoggedIn] = React.useState(false);\r\nconst [email, setEmail] = React.useState(\"\");\r\nconst [token, setToken] = React.useState(\"\");\r\nconst navigate = useNavigate();\r\n\r\nconst handelLogin =(email)=>{\r\n  setLoggedIn(true)\r\n  setEmail(email)\r\n  navigate(\"/\");\r\n}\r\n// const handelLogout =()=>{\r\n//   setLoggedIn(false)\r\n// }\r\n const tokenCheck=()=>{\r\n  const jwt = localStorage.getItem('jwt');\r\n  if (jwt) {\r\n    auth.checkToken(jwt).then((res) => {\r\n      if(res.status === 400) {  \r\n        console.log( \" Token not provided or provided in the wrong format \")\r\n    }\r\n      if(res.status === 401) {  \r\n        console.log( \"The provided token is invalid\")\r\n    }\r\n      if (res) {\r\n        handelLogin()\r\n        setEmail(res.data.email)\r\n        navigate(\"/\");\r\n      }\r\n    }).catch(err => {console.log(err)\r\n    localStorage.clear()\r\n    });;\r\n  }\r\n\r\n\r\n} \r\n\r\nconst handelLoginSubmit =({email,password})=>{\r\n  auth.login(email, password)\r\n            .then((data) => {\r\n\r\n                if (data.token) {\r\n                    localStorage.setItem('jwt', data.token);\r\n                    handelLogin(email)\r\n                    setToken(data.token)\r\n\r\n                }\r\n                if (data.status === 400) {\r\n                    console.log(\" one or more of the fields were not provided \")\r\n                }\r\n                if (data.status === 401) {\r\n                    console.log(\"the user with the specified email not found \")\r\n                }\r\n                \r\n               \r\n            }).catch(err => console.log(err));\r\n\r\n}\r\n\r\n\r\nReact.useEffect(() => {\r\n  tokenCheck()\r\n}, []);\r\n\r\n\r\n\r\n    return  (\r\n    <Routes>\r\n    <Route exact path=\"/\" element={<ProtectedRoute isLoggedIn={loggedIn}  email={email} component={App}/>}/>\r\n    <Route path=\"/signin\" element={<Login handelLoginSubmit={handelLoginSubmit}/>}/>\r\n      <Route path=\"/signup\" element={<Register />}/>\r\n  \r\n    </Routes>\r\n\r\n)\r\n\r\n}\r\n\r\nexport default Router\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}